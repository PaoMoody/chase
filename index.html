<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Animal Chase Game</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      font-family: 'Avenir', sans-serif;
      background-color: #ffffff;
    }
    #gameArea {
      width: 100vw;
      height: 100vh;
      position: relative;
    }
    .animal {
      width: 80px;
      height: 80px;
      position: absolute;
      transition: top 1.0s, left 1.0s;
      cursor: pointer;
    }
    #kid {
      width: 100px;
      height: 100px;
      position: absolute;
      left: 50px;
      top: 50px;
      transition: top 1s, left 1s;
      z-index: 2;
    }
    #message {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: #e95732;
      color: white;
      padding: 20px 30px;
      border-radius: 10px;
      font-weight: bold;
      display: none;
      z-index: 3;
      text-align: center;
    }
    #scoreBoard {
      position: absolute;
      top: 20px;
      right: 20px;
      background: #ffc764;
      padding: 10px 20px;
      border-radius: 10px;
      font-weight: bold;
      color: #000;
      z-index: 3;
    }
    #timer {
      position: absolute;
      top: 20px;
      left: 20px;
      background: #5e98ab;
      color: white;
      padding: 10px 20px;
      border-radius: 10px;
      font-weight: bold;
      z-index: 3;
    }
    #finalButtons {
      margin-top: 20px;
    }
    .final-btn {
      margin: 10px;
      padding: 10px 20px;
      background-color: #5e98ab;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div id="gameArea">
    <img id="kid" src="Kid.png" alt="kid">
    <div id="message"></div>
    <div id="scoreBoard">Score: 0</div>
    <div id="timer">Time: 45</div>
  </div>
  <script>
    const animalData = [
      { short: 'cat', long: 'acorn' },
      { short: 'hen', long: 'bee' },
      { short: 'pig', long: 'ice-cream' },
      { short: 'dog', long: 'boat' },
      { short: 'bug', long: 'unicorn' },
    ];

    const gameArea = document.getElementById('gameArea');
    const kid = document.getElementById('kid');
    const message = document.getElementById('message');
    const scoreBoard = document.getElementById('scoreBoard');
    const timerDisplay = document.getElementById('timer');

    let score = 0;
    let timeLeft = 45;
    let gameInterval;
    let totalShown = 0;
    let bestScore = localStorage.getItem('chaseBestScore') || 0;
    let gameOver = false;

    function updateScore() {
      score++;
      scoreBoard.textContent = `Score: ${score}`;
    }

    function spawnAnimal() {
      if (gameOver) return;
      const data = animalData[Math.floor(Math.random() * animalData.length)];
      const img = document.createElement('img');
      img.src = `${data.short}.png`;
      img.className = 'animal';
      img.style.top = Math.random() * (window.innerHeight - 100) + 'px';
      img.style.left = Math.random() * (window.innerWidth - 100) + 'px';
      gameArea.appendChild(img);
      totalShown++;

      img.addEventListener('click', () => {
        if (gameOver) return;
        const rect = img.getBoundingClientRect();
        kid.style.left = rect.left + 'px';
        kid.style.top = rect.top + 'px';

        setTimeout(() => {
          img.src = `${data.long}.png`;
          new Audio(`${data.short}.mp3`).play();
          setTimeout(() => {
            new Audio(`${data.long}.mp3`).play();
            updateScore();
            img.remove();
          }, 1000);
        }, 1000);
      });

      const moveInterval = setInterval(() => {
        if (!img.parentElement || gameOver) return clearInterval(moveInterval);
        img.style.top = Math.random() * (window.innerHeight - 100) + 'px';
        img.style.left = Math.random() * (window.innerWidth - 100) + 'px';
      }, 2000);

      setTimeout(() => {
        if (img.parentElement) img.remove();
      }, 8000);
    }

    function showFinalMessage(text) {
      message.innerHTML = text + '<div id="finalButtons">' +
        '<button class="final-btn" onclick="location.reload()">Play Again</button>' +
        '<button class="final-btn" onclick="window.location.href=\"index.html\"">Home</button>' +
        '</div>';
      message.style.display = 'block';
    }

    function startGame() {
      gameInterval = setInterval(spawnAnimal, 1500);

      const timer = setInterval(() => {
        timeLeft--;
        timerDisplay.textContent = `Time: ${timeLeft}`;
        if (timeLeft <= 0) {
          clearInterval(timer);
          clearInterval(gameInterval);
          gameOver = true;

          document.querySelectorAll('.animal').forEach(a => a.remove());

          let result = `Time's up!<br>You caught <strong>${score}</strong> animals out of <strong>${totalShown}</strong> shown.`;
          if (score > bestScore) {
            localStorage.setItem('chaseBestScore', score);
            result += '<br>ðŸŽ‰ <strong>New record!</strong>';
          }
          showFinalMessage(result);
        }
      }, 1000);
    }

    startGame();
  </script>
</body>
</html>
